desc "get app build number"
desc "platform: ios | android"
private_lane :get_app_version do |options|
	platform = options[:platform]

    version = ''

	appBuildGradlePath = '../android/app/build.gradle'
	pbxprojPath = '../ios/entourage.xcodeproj/project.pbxproj'

    if platform == "android"
		versionNameRegex = /versionName\s+"([\d.]+)"/
		appBuildGradle = File.read(appBuildGradlePath)
		match = appBuildGradle.match(versionNameRegex)
		if match
			version = match[1]
		else
			puts "Version name not found in the build.gradle file."
		end
	else
		marketingVersionRegex = /MARKETING_VERSION = ([\d.]+);/
		pbxproj = File.read(pbxprojPath)
		match = pbxproj.match(marketingVersionRegex)

		if match
			version = match[1]
		else
			puts "Version name not found in the pbxproj file."
		end
	end
	
	if version === '' and platform == "android"
		versionNameRegex = /versionName\s+'(\d+\.\d+-\w+-\w+)'/ 
		appBuildGradle = File.read(appBuildGradlePath)
		version = appBuildGradle[versionNameRegex, 1]
	elsif version === '' and platform == "ios"
		marketingVersionRegex = /MARKETING_VERSION = (\d+\.\d+-\w+-\w+);/
		pbxproj = File.read(pbxprojPath)
		version = pbxproj[marketingVersionRegex, 1]
	end

    version
end